<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Pandas &#8212; DataTech 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="pandas">
<h1>Pandas<a class="headerlink" href="#pandas" title="Permalink to this headline">¶</a></h1>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>One might think that we have everything that we need to work with data.
We can read data with built-in Python functions and we can store and
manipulate that data with Numpy. Numpy is based around the Array, and
Pandas is based around the DataFrame. Unlike the Array, the Dataframe
treats each axis differently, with named columns and indexed rows.
Pandas does this under the assumption that a DataFrame holds a large
sample of a limited number of variables. Each column corresponds to a
variable, while each row corresponds to an individual, time-point, or
other index for repeated data.</p>
<p>Due to this presumption, Pandas is able to optimize operations such as
indexing, aggregation, and time series statistics. It also has great
Input/Output tools for reading delimited data, working with databases,
and HDF5 data. Pandas is built around the data types: DataFrames,
Series. Roughly, a Series is a list of indices and values (think of a
time series where the datatime is the index), and a DataFrame is a
dictionary where the keys are the column names and the values are entire
Series, and these Series have a common index. This is a high-level
overview of Pandas, and for more syntax details see
<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/">http://pandas.pydata.org/pandas-docs/stable/</a></p>
<div class="section" id="series">
<h2>Series<a class="headerlink" href="#series" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s simulate a Brownian motion so that we can discuss Series objects.
You can see a plot of this below, we will go over data visualization in
the next chapter.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">innov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
<span class="n">brown</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">innov</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">brown</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="unit1/images/output_5_0.png" src="unit1/images/output_5_0.png" />
<p>Let&#8217;s suppose that the above simulation represents the change in a stock
price starting from Jan 1, 2015. Pandas provides a tool for making
sequences of datetimes; the following makes a DateTimeIndex object.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">days</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;1/1/2015&#39;</span><span class="p">,</span><span class="n">periods</span><span class="o">=</span><span class="n">T</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We will return to datetime functionality in Pandas later. Another option
for working with datetimes is the <code class="docutils literal"><span class="pre">datetime</span></code> package, which has the
date, time, and datetime types and a timedelta object for increments of
time. To see the specifics of the <code class="docutils literal"><span class="pre">datetime</span></code> package you can look at
<a class="reference external" href="https://docs.python.org/3.7/library/datetime.html">https://docs.python.org/3.7/library/datetime.html</a></p>
<p>The resulting list contains the dates, for example,</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">days</span><span class="p">[</span><span class="mi">600</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2016-08-23 00:00:00&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can initialize a series with a 1D array and an index sequence. If you
omit the index then it will index with the row number. You can also
initialize with dictionaries where the index values are the keys and the
values are the data.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">stock</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">brown</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">days</span><span class="p">)</span>
</pre></div>
</div>
<p>The Series object should be thought of as a vector of data where each
value is attached to an index value. Series operations will preserve the
indices when they can. You can slice a series as if it were an array; in
the following, we look at every seventh day in the first 100 days.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">stock</span><span class="p">[:</span><span class="mi">100</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>   <span class="o">-</span><span class="mf">0.132526</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">08</span>    <span class="mf">3.900432</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">15</span>    <span class="mf">7.371181</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">22</span>    <span class="mf">6.224340</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">29</span>    <span class="mf">3.449301</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">05</span>    <span class="mf">1.346746</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">12</span>    <span class="mf">2.084879</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">19</span>   <span class="o">-</span><span class="mf">0.752967</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">26</span>   <span class="o">-</span><span class="mf">0.983502</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span>   <span class="o">-</span><span class="mf">0.575965</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">12</span>    <span class="mf">1.140087</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">19</span>   <span class="o">-</span><span class="mf">2.205040</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span>   <span class="o">-</span><span class="mf">2.214539</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">02</span>   <span class="o">-</span><span class="mf">1.170000</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">09</span>   <span class="o">-</span><span class="mf">1.984565</span>
<span class="n">Freq</span><span class="p">:</span> <span class="mi">7</span><span class="n">D</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>Due to the indexing, we can also think of this as a dictionary, as in
the following.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">stock</span><span class="p">[</span><span class="s1">&#39;2016/7/27&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">11.191250684953793</span>
</pre></div>
</div>
<p>One of the key features that makes the series different from an array is
that operations between two series will align the indices. For example,
suppose that we have bought 100 shares of another stock on Jan 1, 2016,
which we can simulate as well. As usual, since we are reusing code,
let&#8217;s wrap it up in a function which we could put in a module.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">stock_sim</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">day1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simulate a stock for T days starting from day1&quot;&quot;&quot;</span>
    <span class="n">innov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
    <span class="n">brown</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">innov</span><span class="p">)</span>
    <span class="n">days</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">day1</span><span class="p">,</span><span class="n">periods</span><span class="o">=</span><span class="n">T</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">brown</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">days</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">-</span> <span class="mi">365</span>
<span class="n">day1</span> <span class="o">=</span> <span class="s1">&#39;2016/1/1&#39;</span>
<span class="n">stock_2</span> <span class="o">=</span> <span class="n">stock_sim</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">day1</span><span class="p">)</span>
</pre></div>
</div>
<p>For each date we would like to see the difference between the value of
the portfolio and the amount we spent on the portfolio. This is
proportional to the sum of the two changes in stock price since we have
bought even amounts of each stock.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">portfolio</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">stock_2</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">stock</span></code> and <code class="docutils literal"><span class="pre">stock_2</span></code> have different lengths but we are able to add
them because the indices can be matched. So after 2016 the change in
value of stock 2 is added to stock 1 since that will correspond to the
change in portfolio value. We had to specify a <code class="docutils literal"><span class="pre">fill_value</span></code> of 0
otherwise it would try report the portfolio value as missing before
2016. We can plot this.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="c1"># See next chapter</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">portfolio</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Portfolio gain&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="unit1/images/output_22_0.png" src="unit1/images/output_22_0.png" />
</div>
<div class="section" id="dataframe">
<h2>Dataframe<a class="headerlink" href="#dataframe" title="Permalink to this headline">¶</a></h2>
<p>You should think of a dataframe as a collection of series objects with a
common index. Each series in the dataframe has a different name, and
they should be thought of as different variables. We can initialize the
dataframe with a dictionary mapping names to series objects.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">port_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;stock 1&#39;</span><span class="p">:</span><span class="n">stock</span><span class="p">,</span><span class="s1">&#39;stock 2&#39;</span><span class="p">:</span><span class="n">stock_2</span><span class="p">,</span><span class="s1">&#39;portfolio&#39;</span><span class="p">:</span><span class="n">portfolio</span><span class="p">})</span>
</pre></div>
</div>
<p>If we had passed arrays instead of series then the default index of the
row numbers would be used. You can also pass a 2D array and specify the
<code class="docutils literal"><span class="pre">indices</span></code> and <code class="docutils literal"><span class="pre">columns</span></code> arguments. There are other ways to
initialize a dataframe, such as from lists of tuples and lists of
dictionaries.</p>
<p>We can view the first few rows of any dataframe with the <code class="docutils literal"><span class="pre">head</span></code>
method.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">port_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stock 1</th>
      <th>stock 2</th>
      <th>portfolio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-01-01</th>
      <td>-0.132526</td>
      <td>NaN</td>
      <td>-0.132526</td>
    </tr>
    <tr>
      <th>2015-01-02</th>
      <td>-0.087030</td>
      <td>NaN</td>
      <td>-0.087030</td>
    </tr>
    <tr>
      <th>2015-01-03</th>
      <td>-1.578688</td>
      <td>NaN</td>
      <td>-1.578688</td>
    </tr>
    <tr>
      <th>2015-01-04</th>
      <td>-0.240958</td>
      <td>NaN</td>
      <td>-0.240958</td>
    </tr>
    <tr>
      <th>2015-01-05</th>
      <td>1.170581</td>
      <td>NaN</td>
      <td>1.170581</td>
    </tr>
  </tbody>
</table>
</div><p>We see that stock 2 was filled with NaN values. We can also get at the
indices and names via</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">port_df</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">7</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">port_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2015-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-01-04&#39;</span><span class="p">,</span>
               <span class="s1">&#39;2015-01-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-01-06&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-01-07&#39;</span><span class="p">],</span>
              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">Index</span><span class="p">([</span><span class="s1">&#39;stock 1&#39;</span><span class="p">,</span> <span class="s1">&#39;stock 2&#39;</span><span class="p">,</span> <span class="s1">&#39;portfolio&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Accessing elements in a dataframe differs from arrays in the following
ways:</p>
<ul class="simple">
<li>dataframes act like dictionaries from the column names to the column</li>
<li>slicing is done over the row indices</li>
<li>to</li>
</ul>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">port_df</span><span class="p">[</span><span class="s1">&#39;stock 1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># this returns the column</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>   <span class="o">-</span><span class="mf">0.132526</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span>   <span class="o">-</span><span class="mf">0.087030</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span>   <span class="o">-</span><span class="mf">1.578688</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span>   <span class="o">-</span><span class="mf">0.240958</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span>    <span class="mf">1.170581</span>
<span class="n">Freq</span><span class="p">:</span> <span class="n">D</span><span class="p">,</span> <span class="n">Name</span><span class="p">:</span> <span class="n">stock</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">port_df</span><span class="p">[</span><span class="s1">&#39;2015/1/1&#39;</span><span class="p">:</span><span class="s1">&#39;2016/1/1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1">#this returns a slice of rows</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stock 1</th>
      <th>stock 2</th>
      <th>portfolio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-01-01</th>
      <td>-0.132526</td>
      <td>NaN</td>
      <td>-0.132526</td>
    </tr>
    <tr>
      <th>2015-01-02</th>
      <td>-0.087030</td>
      <td>NaN</td>
      <td>-0.087030</td>
    </tr>
    <tr>
      <th>2015-01-03</th>
      <td>-1.578688</td>
      <td>NaN</td>
      <td>-1.578688</td>
    </tr>
    <tr>
      <th>2015-01-04</th>
      <td>-0.240958</td>
      <td>NaN</td>
      <td>-0.240958</td>
    </tr>
    <tr>
      <th>2015-01-05</th>
      <td>1.170581</td>
      <td>NaN</td>
      <td>1.170581</td>
    </tr>
  </tbody>
</table>
</div><p>Boolean fancy indexing works in the place of the slice above as well,
for example, we can select rows with a boolean series,</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">port_df</span><span class="p">[</span><span class="n">port_df</span><span class="p">[</span><span class="s1">&#39;portfolio&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">port_df</span><span class="p">[</span><span class="s1">&#39;stock 1&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stock 1</th>
      <th>stock 2</th>
      <th>portfolio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-01-01</th>
      <td>8.154289</td>
      <td>0.702001</td>
      <td>8.856290</td>
    </tr>
    <tr>
      <th>2016-01-12</th>
      <td>3.746795</td>
      <td>0.412568</td>
      <td>4.159364</td>
    </tr>
    <tr>
      <th>2016-01-13</th>
      <td>1.930705</td>
      <td>0.585910</td>
      <td>2.516615</td>
    </tr>
    <tr>
      <th>2016-01-18</th>
      <td>-2.250490</td>
      <td>0.158522</td>
      <td>-2.091968</td>
    </tr>
    <tr>
      <th>2016-01-19</th>
      <td>-1.874360</td>
      <td>0.796581</td>
      <td>-1.077779</td>
    </tr>
  </tbody>
</table>
</div><p>which will find the elements in which the portfolio is better off than
just our share in stock 1. The comparison between the portfolio and
stock 1 is not quite fair because we invested more money in the
portfolio. We can create new columns via the following assignment,</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">s1sim</span> <span class="o">=</span> <span class="n">port_df</span><span class="p">[</span><span class="s1">&#39;stock 1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">port_df</span><span class="p">[</span><span class="s1">&#39;stock 1&#39;</span><span class="p">][</span><span class="s1">&#39;2016/1/1&#39;</span><span class="p">:],</span><span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">port_df</span><span class="p">[</span><span class="s1">&#39;stock 1 sim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s1sim</span>
<span class="n">port_df</span><span class="p">[</span><span class="n">port_df</span><span class="p">[</span><span class="s1">&#39;portfolio&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">port_df</span><span class="p">[</span><span class="s1">&#39;stock 1 sim&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stock 1</th>
      <th>stock 2</th>
      <th>portfolio</th>
      <th>stock 1 sim</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-01-16</th>
      <td>-2.004913</td>
      <td>-1.310433</td>
      <td>-3.315347</td>
      <td>-4.009827</td>
    </tr>
    <tr>
      <th>2016-01-17</th>
      <td>-2.863114</td>
      <td>-0.532889</td>
      <td>-3.396003</td>
      <td>-5.726228</td>
    </tr>
    <tr>
      <th>2016-01-18</th>
      <td>-2.250490</td>
      <td>0.158522</td>
      <td>-2.091968</td>
      <td>-4.500980</td>
    </tr>
    <tr>
      <th>2016-01-19</th>
      <td>-1.874360</td>
      <td>0.796581</td>
      <td>-1.077779</td>
      <td>-3.748719</td>
    </tr>
    <tr>
      <th>2016-01-20</th>
      <td>-1.835044</td>
      <td>1.822567</td>
      <td>-0.012477</td>
      <td>-3.670089</td>
    </tr>
  </tbody>
</table>
</div><p>We added the value of stock 1 after 2016 to all of stock 1 to see what
the price would be if we invested in stock 1 again on Jan 1, 2016. If we
wanted to select instead a specific date, we would need to use the
<code class="docutils literal"><span class="pre">loc</span></code> method,</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">port_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2016/7/27&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">stock</span> <span class="mi">1</span>        <span class="mf">11.191251</span>
<span class="n">stock</span> <span class="mi">2</span>         <span class="mf">2.867483</span>
<span class="n">portfolio</span>      <span class="mf">14.058734</span>
<span class="n">stock</span> <span class="mi">1</span> <span class="n">sim</span>    <span class="mf">22.382501</span>
<span class="n">Name</span><span class="p">:</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">27</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>We can select and slice the dataframe as if it were a Numpy array using
the <code class="docutils literal"><span class="pre">iloc</span></code> method,</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">port_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">400</span><span class="p">:</span><span class="mi">405</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stock 1</th>
      <th>stock 2</th>
      <th>portfolio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-02-05</th>
      <td>-3.581697</td>
      <td>6.968880</td>
      <td>3.387182</td>
    </tr>
    <tr>
      <th>2016-02-06</th>
      <td>-3.854760</td>
      <td>6.472026</td>
      <td>2.617266</td>
    </tr>
    <tr>
      <th>2016-02-07</th>
      <td>-2.697462</td>
      <td>7.555933</td>
      <td>4.858471</td>
    </tr>
    <tr>
      <th>2016-02-08</th>
      <td>-4.389190</td>
      <td>10.106156</td>
      <td>5.716965</td>
    </tr>
    <tr>
      <th>2016-02-09</th>
      <td>-4.027021</td>
      <td>8.067919</td>
      <td>4.040898</td>
    </tr>
  </tbody>
</table>
</div><p>Other things to be aware of are</p>
<ul class="simple">
<li>the <code class="docutils literal"><span class="pre">info</span></code> method which provides the types and information of the
columns,</li>
<li>many elementwise Numpy operations can be performed on series and
dataframes, such as <code class="docutils literal"><span class="pre">np.exp</span></code></li>
<li>Pandas has many of the same descriptive statistics such as
<code class="docutils literal"><span class="pre">dataframe.mean()</span></code> including <code class="docutils literal"><span class="pre">min,</span> <span class="pre">max,</span> <span class="pre">std,</span> <span class="pre">count,...</span></code></li>
</ul>
<p>We can see many of the descriptive statistics with the <code class="docutils literal"><span class="pre">describe</span></code>
method.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">port_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stock 1</th>
      <th>stock 2</th>
      <th>portfolio</th>
      <th>stock 1 sim</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1000.000000</td>
      <td>635.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.209039</td>
      <td>8.755110</td>
      <td>7.768534</td>
      <td>2.802033</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6.782089</td>
      <td>9.029220</td>
      <td>11.534137</td>
      <td>12.119164</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-13.394813</td>
      <td>-14.372408</td>
      <td>-20.329462</td>
      <td>-26.789627</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-2.834049</td>
      <td>3.965685</td>
      <td>0.280122</td>
      <td>-4.962457</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.748605</td>
      <td>11.666626</td>
      <td>7.178422</td>
      <td>4.646818</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>7.014775</td>
      <td>15.381508</td>
      <td>16.705302</td>
      <td>10.896449</td>
    </tr>
    <tr>
      <th>max</th>
      <td>16.995441</td>
      <td>23.052934</td>
      <td>32.141200</td>
      <td>29.696000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Pandas</a><ul>
<li><a class="reference internal" href="#series">Series</a></li>
<li><a class="reference internal" href="#dataframe">Dataframe</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/unit1/images/pandas.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, James Sharpnack.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="../../_sources/unit1/images/pandas.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>